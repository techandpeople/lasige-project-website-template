---
import { getCollection, render } from 'astro:content';
import { getLocalizedEntries } from '../i18n';
import TeamCard from './TeamCard.astro';

interface Props {
	lang: string;
	siteConfig: Record<string, any>;
}

const { lang, siteConfig } = Astro.props;
const allMembers = await getCollection('team');
const members = getLocalizedEntries(allMembers, lang);
const sorted = [...members].sort((a, b) => a.data.order - b.data.order);
const title = siteConfig.team?.title || 'Team';

const rendered = await Promise.all(
	sorted.map(async (entry) => {
		const { Content } = await render(entry);
		return { entry, Content };
	})
);
---
{sorted.length > 0 && (
	<section id="team" class="py-20">
		<div class="max-w-6xl mx-auto px-4">
			<h2 class="text-3xl md:text-4xl font-bold text-primary mb-4 text-center">
				{title}
			</h2>
			<div class="w-16 h-1 bg-accent mx-auto mb-12 rounded-full"></div>

			<div class="flex flex-wrap justify-center gap-6">
				{rendered.map(({ entry, Content }) => (
					<TeamCard member={entry.data} hasBody={!!entry.body?.trim()}>
						<Content />
					</TeamCard>
				))}
			</div>
		</div>
	</section>
)}
